<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>AlgoTune</title>
    <link rel="icon" type="image/png" href="assets/AlgoTunerMascot.png">
    
    <!-- Social Preview Tags -->
    <meta property="og:title" content="AlgoTune">
    <meta property="og:description" content="Can Language Models Speed Up General-Purpose Numerical Programs?">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://algotune.io">
    <meta property="og:image" content="https://algotune.io/assets/algotune_banner.png">
    <meta property="og:image:alt" content="AlgoTune - Can Language Models Speed Up General-Purpose Numerical Programs?">
    <meta property="og:site_name" content="AlgoTune">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AlgoTune">
    <meta name="twitter:description" content="Can Language Models Speed Up General-Purpose Numerical Programs?">
    <meta name="twitter:image" content="https://algotune.io/assets/algotune_banner.png">
    <meta name="twitter:image:alt" content="AlgoTune - Can Language Models Speed Up General-Purpose Numerical Programs?">
    
    <meta name="description" content="AlgoTune: Can Language Models Speed Up General-Purpose Numerical Programs?">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Prism.js for syntax highlighting - loaded after styles.css to ensure proper precedence -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7XSBWH5NQF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){{dataLayer.push(arguments);}}
      gtag('js', new Date());

      gtag('config', 'G-7XSBWH5NQF');
    </script>

    <style>
      /* Responsive styles for leaderboard table */
      @media (max-width: 768px) {
        .leaderboard-table-container {
          max-width: 400px !important;
        }
      }
      
      @media (max-width: 480px) {
        .leaderboard-table-container {
          max-width: 280px !important;
        }
        
        .leaderboard-table-container table {
          font-size: 0.85rem;
        }
        
        .leaderboard-table-container th,
        .leaderboard-table-container td {
          padding: 8px 6px;
        }
      }
      
      /* Make code block larger on desktop */
      .algotune-code-example {
        font-size: 1rem !important;
        line-height: 1.4 !important;
      }
      
      @media (max-width: 768px) {
        .algotune-code-example {
          font-size: 0.8rem !important;
          line-height: 1.25 !important;
        }
      }
      
    </style>

    <style>
      /* ---------------------------------------------------- */
      /* Additional mobile tweaks (logos, buttons, table)    */
      /* ---------------------------------------------------- */

      /* Narrower leaderboard table widths */
      @media (max-width: 768px) {
        /* Keep leaderboard adjustments */
        .leaderboard-table-container {
          max-width: 320px !important;
        }

        /* Stack header elements vertically on tablets & mobile */
        .authors-section {
          flex-direction: column !important;
          gap: 10px;
          align-items: center;
          justify-content: center;
        }

        /* Ensure authors list comes first */
        .authors-container {
          order: 0;
          width: 100%;
          margin-bottom: 10px;
        }

        /* Container holding both logos side-by-side */
        .university-logos {
          order: 1;
          display: flex !important;
          flex-direction: row !important;
          gap: 12px;
          justify-content: center;
          align-items: center;
          width: 100%;
        }

        .university-logo {
          height: 30px;
          width: 30px;
          object-fit: contain;
        }

        /* Slightly enlarge Princeton logo for visual balance - override external CSS */
        .university-logos .university-logo.right-logo {
          height: 40px !important;
          width: auto !important;
          max-height: 40px !important;
          min-height: 40px !important;
        }
        
        /* Ensure both logos have consistent sizing on mobile */
        .university-logos .university-logo {
          height: 40px !important;
          width: auto !important;
          max-height: 40px !important;
          min-height: 40px !important;
        }
        

        /* Buttons row */
        .buttons-container {
          order: 2;
          width: 100%;
          display: flex;
          justify-content: center;
          gap: 16px;
          margin-top: 16px;
          flex-wrap: nowrap;
        }

        .buttons-container .button {
          flex: 1;
          min-width: 120px;
          max-width: 150px;
          text-align: center;
          padding: 10px 16px;
        }
      }

      @media (max-width: 480px) {
        .leaderboard-table-container {
          width: 100% !important;          /* fill available space */
          max-width: 100% !important;     /* override inline 600px limit */
          overflow-x: hidden;             /* no horizontal scroll */
          padding: 0 6px;                 /* keep some breathing room */
          box-sizing: border-box;
        }
        .leaderboard-table-container table {
          font-size: 0.9rem;
          table-layout: fixed;
          width: 100%;
          min-width: 280px;               /* prevent excessive squeezing */
        }
        .leaderboard-table-container th,
        .leaderboard-table-container td {
          padding: 2px 1px;
        }
        
        /* Allow first column (model names) to wrap on mobile */
        .leaderboard-table-container td:first-child {
          white-space: normal;
          word-break: break-word;
          line-height: 1.2;
        }
        
        /* Keep second column (scores) single line and centered */
        .leaderboard-table-container td:nth-child(2),
        .leaderboard-table-container th:nth-child(2) {
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        /* Buttons side by side on small mobile */
        .buttons-container {
          flex-direction: row !important;
          gap: 10px;
          justify-content: center;
        }
      }

      /* Desktop: place TÃ¼bingen logo to the left of the authors and
         Princeton logo to the right by adjusting flex order */
      .university-logo.left-logo {
        order: -1;   /* precedes the author list */
      }

      .university-logo.right-logo {
        order: 1;    /* follows the author list */
      }
    </style>

    <!-- Mobile clean-up: remove emojis / markers in speedup timeline -->
    <style>
      @media (max-width: 768px) {
        .timeline-marker {
          display: none !important;
        }
        .performance-rank {
          display: none !important;  /* hide numeric order on mobile */
        }
        .mobile-hint::before {
          content: "" !important;
        }
      }
    </style>

    <style>
      /* Custom mobile overrides for leaderboard table */
      @media (max-width: 480px) {
        .leaderboard-table-container {
          overflow-y: hidden !important; /* eliminate vertical scrollbar */
        }
        .leaderboard-table-container table {
          font-size: 1rem !important; /* slightly larger font */
        }
        /* Center align the second column (AlgoTune Score) on mobile */
        .leaderboard-table-container td:nth-child(2),
        .leaderboard-table-container th:nth-child(2) {
          text-align: center !important;
        }
        
        /* Adjust logo sizes for mobile */
        .model-logo {
          height: 16px !important;
        }
        
        .model-logo-small {
          height: 12px !important;
        }
      }
      
      /* Center align the second column (AlgoTune Score) on desktop too */
      .leaderboard-table-container td:nth-child(2),
      .leaderboard-table-container th:nth-child(2) {
        text-align: center;
      }
      
      /* Model logo styles */
      .model-logo {
        height: 18px;
        width: auto;
        vertical-align: middle;
        margin-right: 6px;
        border-radius: 2px;
      }
      
      .model-logo-small {
        height: 14px;
        width: auto;
        vertical-align: middle;
        margin-right: 4px;
        border-radius: 2px;
      }

      /* Job Market Banner Styles */
      .job-market-banner {
        background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
        color: white;
        text-align: center;
        padding: 8px 16px;
        font-size: 0.9rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        position: relative;
        z-index: 1000;
      }

      /* NeurIPS label under title */
      .algotune-conference {
        display: inline-block;
        align-self: center;
        text-align: center;
        font-weight: 600; /* a bit quieter than 700 */
        font-size: 1.05rem; /* slightly smaller */
        letter-spacing: 0.06em;
        text-transform: none; /* keep mixed-case 'NeurIPS' */
        padding: 6px 12px;
        /* tighten spacing below the NeurIPS label */
        margin: 12px 0 0 0; /* no extra space underneath */
        color: #000000; /* black font for better contrast */
        /* softer, neutral background instead of vivid gradient */
        background: linear-gradient(135deg, #f4f6f8 0%, #eef2f6 100%);
        border-radius: 999px; /* pill */
        box-shadow: 0 2px 6px rgba(0,0,0,0.06);
        border: 2px solid #001f3f; /* navy blue border for NeurIPS 2025 */
      }

      /* Remove extra gap between NeurIPS label and authors row */
      .authors-section {
        padding-top: 0 !important;
        margin-top: 0 !important;
      }
      
      .banner-content {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
      }
      
      .job-market-banner a {
        color: #ffeb3b;
        text-decoration: underline;
        font-weight: 500;
      }
      
      .job-market-banner a:hover {
        color: #fff;
        text-decoration: none;
      }
      
      /* Mobile responsive adjustments */
      @media (max-width: 768px) {
        .job-market-banner {
          padding: 6px 12px;
          font-size: 0.85rem;
        }
        
        .banner-content {
          flex-direction: column;
          gap: 4px;
          text-align: center;
        }
      }
    </style>
</head>
<body>

    <header class="header-section">
        <div class="header-content">
            <div class="algotune-banner">
                <div class="algotune-text">
                    <h1 class="algotune-title">
                        <img src="assets/AlgoTunerMascot.png" alt="AlgoTune Mascot" class="algotune-mascot-inline">
                        AlgoTune
                    </h1>
                    <p class="algotune-subtitle">Can Language Models Speed Up General-Purpose Numerical Programs?</p>
                    <div class="algotune-conference">NeurIPS 2025</div>
                </div>
            </div>
            
            <div class="authors-section">
                <div class="authors-container">
                    <a class="author-name" href="https://oripress.com" target="_blank" rel="noopener noreferrer">Ori Press</a>
                    <a class="author-name" href="https://bamos.github.io/" target="_blank" rel="noopener noreferrer">Brandon Amos</a>
                    <a class="author-name" href="https://hyzhao.me/" target="_blank" rel="noopener noreferrer">Haoyu Zhao</a>
                    <a class="author-name" href="https://yikai-wu.github.io/" target="_blank" rel="noopener noreferrer">Yikai Wu</a>
                    <a class="author-name" href="https://samlikes.pizza/" target="_blank" rel="noopener noreferrer">Samuel K. Ainsworth</a>
                    <a class="author-name" href="https://krupke.cc/" target="_blank" rel="noopener noreferrer">Dominik Krupke</a>
                    <a class="author-name" href="https://kidger.site/" target="_blank" rel="noopener noreferrer">Patrick Kidger</a>
                    <span class="author-name">Touqir Sajed</span>
                    <a class="author-name" href="https://stellato.io/" target="_blank" rel="noopener noreferrer">Bartolomeo Stellato</a>
                    <a class="author-name" href="https://jisunp515.github.io/" target="_blank" rel="noopener noreferrer">Jisun Park</a>
                    <a class="author-name" href="https://nathanaelbosch.github.io/" target="_blank" rel="noopener noreferrer">Nathanael Bosch</a>
                    <span class="author-name">Eli Meril</span>
                    <span class="author-name">Albert Steppi</span>
                    <a class="author-name" href="https://arman-z.github.io/" target="_blank" rel="noopener noreferrer">Arman Zharmagambetov</a>
                    <a class="author-name" href="https://fangzhaoz.github.io/" target="_blank" rel="noopener noreferrer">Fangzhao Zhang</a>
                    <a class="author-name" href="https://davidppineiro.com/" target="_blank" rel="noopener noreferrer">David PÃ©rez-PiÃ±eiro</a>
                    <span class="author-name">Alberto Mercurio</span>
                    <a class="author-name" href="https://jennyzhanni.com/" target="_blank" rel="noopener noreferrer">Ni Zhan</a>
                    <a class="author-name" href="https://talorabr.github.io/" target="_blank" rel="noopener noreferrer">Talor Abramovich</a>
                    <a class="author-name" href="https://www.lieret.net/" target="_blank" rel="noopener noreferrer">Kilian Lieret</a>
                    <a class="author-name" href="https://hanlin-zhang.com/" target="_blank" rel="noopener noreferrer">Hanlin Zhang</a>
                    <span class="author-name">Shirley Huang</span>
                    <a class="author-name" href="https://bethgelab.org/" target="_blank" rel="noopener noreferrer">Matthias Bethge</a>
                    <a class="author-name" href="https://ofir.io/about/" target="_blank" rel="noopener noreferrer">Ofir Press</a>
                </div>
                <div class="university-logos">
                    <img src="assets/uni_tuebingen_logo.png" alt="University of TÃ¼bingen Logo" class="university-logo left-logo">
                    <img src="assets/uni_princeton_logo.png" alt="Princeton University Logo" class="university-logo right-logo">
                </div>
            </div>
            
            <div class="buttons-container"> 
                <a href="https://arxiv.org/abs/2507.15887" target="_blank" class="button">
                    <i class="fas fa-file-pdf"></i> Paper
                </a>
                <a href="https://github.com/oripress/AlgoTune" target="_blank" class="button">
                    <i class="fab fa-github"></i> Code
                </a>
            </div>
        </div>
    </header>

    <main class="overview-section" id="overview">
        <div class="overview-content">
            <p class="overview-text">
                Can language models optimize the runtime of popular algorithms like gzip compression, AES encryption or SVD?
                To answer this, we built AlgoTune, a benchmark consisting of more than one hundred widely used math, physics, and computer science functions. 
                For each function, the goal is to write code that is faster than the reference implementation while producing the same outputs as the reference, on a held-out test set of inputs.
                In addition to the benchmark, we also developed AlgoTuner, an agent which enables language models to iteratively optimize code.
            </p>
            
            <img src="assets/algotune_banner.png" alt="AlgoTune Banner" class="algotune-banner" style="width: 78%; max-width: none;">
            
            <p class="overview-text">
                This site contains AlgoTuner trajectories for all AlgoTune tasks. Each entry shows the complete conversation between the model and the AlgoTune environment, including code edits, timing evaluations, and the iterative optimization process.
            </p>
        </div>
    </main>

    <section class="tables-section">
        <div class="tables-content">
            <h2 class="tables-heading" id="leaderboard"><a href="#leaderboard">Leaderboard</a></h2>
            
            <p class="overview-text">
                We use our agent, called AlgoTuner, to optimize functions in AlgoTune, using ten state-of-the-art models. 
                AlgoTuner, using these models, is able to achieve impressive surface-level speedups on many tasks, but is unable to come up with novel algorithms.
            </p>
            
            
    <div class='table-container leaderboard-table-container' style='max-width: 600px; margin: 0 auto; overflow-y: visible; max-height: none;'>
      <table style='cursor: default;' id='model-summary-table'>
        <thead>
          <tr><th>Model Name</th><th>AlgoTune Score</th></tr>
        </thead>
        <tbody>
          
        <tr >
          <td><img src="assets/gemini_logo.png" alt="Gemini 3 Flash Preview logo" class="model-logo"> Gemini 3 Flash Preview</td>
          <td>1.00x</td>
        </tr>
        </tbody>
      </table>
    </div>
            
            <p class="overview-text" style="margin-top: 20px; text-align: left;">
                The AlgoTune score for each model is the harmonic mean of its speedups across all AlgoTune tasks. In the table at the bottom of this page, you can find the speedups achieved by each model on each AlgoTune task.
            </p>
        </div>
    </section>

    <section class="overview-section" id="what-is-task">
        <div class="overview-content">
            <div style="text-align: center; width: 100%;">
                <h3 class="overview-heading" style="font-size: 2em; margin-bottom: 20px; text-align: center !important; text-decoration: none; border: none; border-bottom: none; display: inline-block;">AlgoTune Task Implementation</h3>
            </div>
            
            <p class="overview-text" style="text-align: left; margin-bottom: 6px;">
                To measure speedups for the algorithms in AlgoTune, we implement a class containing three functions for each algorithm.
                One generates problem instances (i.e. in the case of PCA this a matrix and number of components), one method checks that the problem has been solved (i.e. for PCA, we check that the matrix is orthonormal), and the last function is a reference solver (for the PCA task, we just use a PCA solver from scikit-learn).
            </p>
            
            
            <!-- Minimal example collapsible code block -->
            <details class="task-impl-details" style="max-width: 95%; margin: 0;">
              <summary style="cursor: pointer; font-weight: 600; margin: 6px 0 12px 0;">Show code example</summary>
              <pre class="algotune-code-example" style="overflow-x: auto; white-space: pre-wrap; word-break: break-word; margin: 0;"><code class="language-python">    def generate_problem(self, n: int, random_seed: int = 1) -> dict[str, Any]:
        """
        Generate random data matrix using n to control the hardness
        """
        np.random.seed(random_seed)
        # 50 * n samples
        m = 50 * n

        r = max(2, n * 5)  # factorization rank
        # Step 1: Generate non-negative W and H
        W = np.random.rand(m, r)  # m x r
        H = np.random.rand(r, 10 * n)  # r x (10 n)

        # Step 2: Generate Y = W H + small noise
        Y = W @ H
        noise_level = 0.01

        Y += noise_level * np.random.rand(
            m, 10 * n
        )  # additive small noise to simulate imperfection

        return dict(X=Y.tolist(), n_components=r)

    def solve(self, problem: dict[str, Any]) -> list[list[float]]:
        try:
            # use sklearn.decomposition.PCA to solve the task
            model = sklearn.decomposition.PCA(n_components=problem["n_components"])
            X = np.array(problem["X"])
            X = X - np.mean(X, axis=0)
            model.fit(X)
            V = model.components_
            return V.tolist()
        except Exception as e:
            logging.error(f"Error: {e}")
            n_components = problem["n_components"]
            n, d = np.array(problem["X"]).shape
            V = np.zeros((n_components, n))
            id = np.eye(n_components)
            V[:, :n_components] = id
            return V.tolist()  # return trivial answer

    def is_solution(self, problem: dict[str, Any], solution: list[list[float]]) -> bool:
        try:
            n_components = problem["n_components"]
            V = np.array(solution)
            X = np.array(problem["X"])
            X = X - np.mean(X, axis=0)

            r, n = V.shape
            # make sure that the number of components is satisfied
            if n_components != r:
                return False
            # check shape
            if n != X.shape[1]:
                return False

            tol = 1e-4
            # check if the matrix V is orthonormal
            VVT = V @ V.T
            if not np.allclose(VVT, np.eye(n_components), rtol=tol, atol=tol / 10):
                return False

            # check objective
            res = self.solve(problem)
            V_solver = np.array(res)

            obj_solver = np.linalg.norm(X @ V_solver.T) ** 2
            obj_sol = np.linalg.norm(X @ V.T) ** 2
            if np.allclose(obj_sol, obj_solver, rtol=tol, atol=tol / 10):
                return True
            return False

        except Exception as e:
            logging.error(f"Error when verifying solution: {e}")
            return False</code></pre>
            </details>
        </div>
    </section>

    <section class="tables-section">
        <div class="tables-content">
            <h2 class="tables-heading" id="results-logs"><a href="#results-logs">Results & Logs</a></h2>
    
            
    <div class="sorting-controls">
        <label style="font-weight: 600; margin-right: 1rem;">Sort by:</label>
        <div class="sort-buttons-container">
            <button onclick="sortTable('alphabetical')" id="sort-alphabetical" class="sort-btn active">Alphabetical</button>
            <button onclick="sortTable('speedup-desc')" id="sort-speedup-desc" class="sort-btn">Top Speedup â†“</button>
            <button onclick="sortTable('speedup-asc')" id="sort-speedup-asc" class="sort-btn">Top Speedup â†‘</button>
        </div>
    </div>
    <div id="speedup-section" class="table-container task-table-container" style="position: relative;">
      <!-- Mobile hint -->
      <div class="mobile-hint">
        Click speedups to see full trajectories
      </div>
      
      <!-- Mobile Performance Timeline layout (hidden on desktop) -->
      <div class="mobile-performance-timeline">
        
        <div class="timeline-item" data-task-name="btsp" data-top-speedup="0">
          <div class="timeline-header" onclick="toggleTimelineItem(this)">
            <div class="timeline-marker"></div>
            <div class="timeline-title-section">
              <div class="timeline-task-name" data-tooltip="Bottleneck Traveling Salesman Problem (BTSP) Given a set of cities and the travel times between each pair, the task is to find a tour that visits each city exactly once and returns to the starting city while minimizing the longest single-day travel time. Unlike the classic Traveling Salesman Prob...">
                btsp
              </div>
              <div class="timeline-summary">
                Best: No Success
              </div>
            </div>
            <div class="timeline-toggle">
              <span class="timeline-arrow">â–¼</span>
            </div>
          </div>
          <div class="timeline-content">
            <div class="performance-strips-container">
              
            <div class="performance-strip">
              <div class="performance-rank">1</div>
              <div class="performance-info">
                <a href="btsp_openrouter_minimax_minimax-m2.1.html" class="performance-link">
                  <div class="performance-badge" style="background-color: #B22222;">
                    Minimax M2.1 - Failed
                  </div>
                </a>
              </div>
            </div>
            </div>
          </div>
        </div>
        <div class="timeline-item" data-task-name="group_lasso" data-top-speedup="0">
          <div class="timeline-header" onclick="toggleTimelineItem(this)">
            <div class="timeline-marker"></div>
            <div class="timeline-title-section">
              <div class="timeline-task-name" data-tooltip="Logistic Regression Group Lasso Task: We are given labels y âˆˆ {0,1}^n and a feature matrix X âˆˆ R^{n x (p+1)}. The features are divided into J groups so that X = [(1)^n X_(1) X_(2) ... X_(J)] and each X_(j) âˆˆ R^{n x p_j}. The task is to solve logistic regression with group lasso penalty. We write ...">
                group_lasso
              </div>
              <div class="timeline-summary">
                Best: No Success
              </div>
            </div>
            <div class="timeline-toggle">
              <span class="timeline-arrow">â–¼</span>
            </div>
          </div>
          <div class="timeline-content">
            <div class="performance-strips-container">
              
            <div class="performance-strip">
              <div class="performance-rank">1</div>
              <div class="performance-info">
                <a href="group_lasso_openrouter_minimax_minimax-m2.1.html" class="performance-link">
                  <div class="performance-badge" style="background-color: #B22222;">
                    Minimax M2.1 - Failed
                  </div>
                </a>
              </div>
            </div>
            </div>
          </div>
        </div>
        <div class="timeline-item" data-task-name="kcenters" data-top-speedup="1.1144085981704694">
          <div class="timeline-header" onclick="toggleTimelineItem(this)">
            <div class="timeline-marker"></div>
            <div class="timeline-title-section">
              <div class="timeline-task-name" data-tooltip="Vertex K-Center Problem Given a weighted, undirected graph representing a city&#x27;s neighborhoods and travel times between them, the goal is to establish up to k emergency response centers such that the longest travel time from any neighborhood to its nearest center is minimized. Input: A tuple (G, ...">
                kcenters
              </div>
              <div class="timeline-summary">
                Best: 1.11x
              </div>
            </div>
            <div class="timeline-toggle">
              <span class="timeline-arrow">â–¼</span>
            </div>
          </div>
          <div class="timeline-content">
            <div class="performance-strips-container">
              
            <div class="performance-strip">
              <div class="performance-rank">1</div>
              <div class="performance-info">
                <a href="kcenters_openrouter_google_gemini-3-flash-preview.html" class="performance-link">
                  <div class="performance-badge" style="background-color: #006400;">
                    Gemini 3 Flash Preview - 1.11x
                  </div>
                </a>
              </div>
            </div>
            </div>
          </div>
        </div>
        <div class="timeline-item" data-task-name="kd_tree" data-top-speedup="1.4080682081581466">
          <div class="timeline-header" onclick="toggleTimelineItem(this)">
            <div class="timeline-marker"></div>
            <div class="timeline-title-section">
              <div class="timeline-task-name" data-tooltip="KD-Tree Task: Given a set of points in d-dimensional space and a set of query points, the task is to construct a KD-tree data structure and use it to find the k nearest neighbors for each query point. Input: A dictionary with keys: - &quot;n_points&quot;: An integer representing the number of data points. ...">
                kd_tree
              </div>
              <div class="timeline-summary">
                Best: 1.41x
              </div>
            </div>
            <div class="timeline-toggle">
              <span class="timeline-arrow">â–¼</span>
            </div>
          </div>
          <div class="timeline-content">
            <div class="performance-strips-container">
              
            <div class="performance-strip">
              <div class="performance-rank">1</div>
              <div class="performance-info">
                <a href="kd_tree_openrouter_google_gemini-3-flash-preview.html" class="performance-link">
                  <div class="performance-badge" style="background-color: #006400;">
                    Gemini 3 Flash Preview - 1.41x
                  </div>
                </a>
              </div>
            </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Desktop table layout (hidden on mobile) -->
      <div class="table-wrapper">
        <table id="task-summary-table">
          <thead>
            <tr>
              <th>Task Name</th>
              <th>Best Speedup</th>
              <th>2nd Best Speedup</th>
              <th>3rd Best Speedup</th>
              <th>4th Best Speedup</th>
            </tr>
          </thead>
          <tbody id="task-table-body">
            
        <tr data-task-name="btsp" data-top-speedup="0">
          <td data-tooltip="Bottleneck Traveling Salesman Problem (BTSP) Given a set of cities and the travel times between each pair, the task is to find a tour that visits each city exactly once and returns to the starting city while minimizing the longest single-day travel time. Unlike the classic Traveling Salesman Prob..." class="task-name-cell">btsp</td>
          <td>
            <a href="btsp_openrouter_minimax_minimax-m2.1.html" style="color: #ffffff; text-decoration: none; font-weight: 500; display: block;">
              <span class="score-badge" style="background-color: #B22222; color: #ffffff;">
                Minimax M2.1 (Fail)
              </span>
            </a>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
        </tr>
        <tr data-task-name="group_lasso" data-top-speedup="0">
          <td data-tooltip="Logistic Regression Group Lasso Task: We are given labels y âˆˆ {0,1}^n and a feature matrix X âˆˆ R^{n x (p+1)}. The features are divided into J groups so that X = [(1)^n X_(1) X_(2) ... X_(J)] and each X_(j) âˆˆ R^{n x p_j}. The task is to solve logistic regression with group lasso penalty. We write ..." class="task-name-cell">group_lasso</td>
          <td>
            <a href="group_lasso_openrouter_minimax_minimax-m2.1.html" style="color: #ffffff; text-decoration: none; font-weight: 500; display: block;">
              <span class="score-badge" style="background-color: #B22222; color: #ffffff;">
                Minimax M2.1 (Fail)
              </span>
            </a>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
        </tr>
        <tr data-task-name="kcenters" data-top-speedup="1.1144085981704694">
          <td data-tooltip="Vertex K-Center Problem Given a weighted, undirected graph representing a city&#x27;s neighborhoods and travel times between them, the goal is to establish up to k emergency response centers such that the longest travel time from any neighborhood to its nearest center is minimized. Input: A tuple (G, ..." class="task-name-cell">kcenters</td>
          <td>
            <a href="kcenters_openrouter_google_gemini-3-flash-preview.html" style="color: #ffffff; text-decoration: none; font-weight: 500; display: block;">
              <span class="score-badge" style="background-color: #006400; color: #ffffff;">
                Gemini 3 Flash Preview (1.11x)
              </span>
            </a>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
        </tr>
        <tr data-task-name="kd_tree" data-top-speedup="1.4080682081581466">
          <td data-tooltip="KD-Tree Task: Given a set of points in d-dimensional space and a set of query points, the task is to construct a KD-tree data structure and use it to find the k nearest neighbors for each query point. Input: A dictionary with keys: - &quot;n_points&quot;: An integer representing the number of data points. ..." class="task-name-cell">kd_tree</td>
          <td>
            <a href="kd_tree_openrouter_google_gemini-3-flash-preview.html" style="color: #ffffff; text-decoration: none; font-weight: 500; display: block;">
              <span class="score-badge" style="background-color: #006400; color: #ffffff;">
                Gemini 3 Flash Preview (1.41x)
              </span>
            </a>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
          <td>
            <span class="score-badge" style="background-color: #B22222; color: #ffffff;">-</span>
          </td>
        </tr>
          </tbody>
        </table>
      </div>
      <div class="click-hint-container" style="position: absolute; left: calc(100% + 12px); top: 165px;">
        <span class="click-hint" style="font-size: 0.9rem; color: #666; font-style: italic; display: flex; align-items: center; gap: 8px;">
          <span style="font-size: 1.2rem;">ðŸ‘ˆ</span>
          Click to see full trajectories
        </span>
      </div>
    </div>
    
    
    <style>
    /* Wider container specifically for the big task table */
    .table-container { overflow-x: auto; }
    .task-table-container { width: 90%; margin: 0 auto; position: relative; overflow: visible !important; }
    .task-table-container .table-wrapper { overflow-x: auto; }
    .task-name-cell:hover { background-color: #f8f9fa; }

    /* Make first column wider and keep full table on narrow screens via horizontal scroll */
    #task-summary-table { table-layout: fixed; width: 100%; min-width: 700px; }
    #task-summary-table th:first-child,
    #task-summary-table td:first-child { width: 30%; }

    /* White text inside speedup badges */
    .score-badge, .score-badge *, a .score-badge, a .score-badge * { 
        color: #ffffff !important; 
        cursor: pointer; 
        white-space: nowrap; /* prevent text wrapping so badges don't compress */
    }
    /* Ensure numeric columns have enough width and allow horizontal scroll instead of squeezing */
    #task-summary-table td:nth-child(n+2),
    #task-summary-table th:nth-child(n+2) {
        min-width: 135px;
    }
    /* Make leaderboard table non-clickable */
    #model-summary-table, #model-summary-table *, #model-summary-table td, #model-summary-table th {
        cursor: default !important;
    }
    /* Click hint container and styling - positioned to the right of table */
    .click-hint-container {
        position: absolute !important;
        left: calc(100% + 12px) !important;
        top: 105px !important;
        z-index: 1000 !important;
        white-space: nowrap !important;
        pointer-events: none !important;
        min-width: 200px !important;
    }
    
    .click-hint { 
        font-size: 0.9rem; 
        color: #666; 
        font-style: italic;
        animation: bounce 1.5s ease-in-out infinite; 
        display: inline-block;
    }
    
    @keyframes bounce { 
         0%, 100% { transform: translateY(0px); } 
         50% { transform: translateY(-4px); } 
     }
    
    /* Hide mobile timeline on desktop by default */
    .mobile-performance-timeline {
        display: none;
    }
    
    .mobile-hint {
        display: none;
        text-align: center;
        color: #666;
        font-style: italic;
        margin-bottom: 15px;
        font-size: 0.9rem;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 8px;
    }
    
    /* Base styles for sorting controls */
    .sorting-controls {
        margin-bottom: 20px;
        padding: 15px;
        background: transparent;
        border: none;
    }
    
    .sorting-controls label {
        font-weight: 600;
        margin-right: 1rem;
        color: #333;
        font-size: 1rem;
    }
    
    .sort-buttons-container {
        display: inline-flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
    }
    
    .sort-btn {
        padding: 8px 16px;
        font-size: 0.9rem;
        border: 1px solid #ddd;
        background: white;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-family: inherit;
        font-weight: 500;
        min-height: 40px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    .sort-btn.active {
        background: #2196F3;
        color: white;
        border-color: #2196F3;
        box-shadow: 0 2px 4px rgba(33, 150, 243, 0.3);
    }
    
    .sort-btn:hover:not(.active) {
        background: #f0f0f0;
        border-color: #ccc;
    }
    
    .sort-btn:focus {
        outline: 2px solid #2196F3;
        outline-offset: 2px;
    }
    
    /* Tooltip styles for task descriptions */
    [data-tooltip] {
        position: relative;
        cursor: help;
    }
    
    [data-tooltip]:hover::after {
        content: attr(data-tooltip);
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.9);
        color: white;
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 0.85rem;
        white-space: normal;
        max-width: 300px;
        width: max-content;
        z-index: 1000;
        line-height: 1.4;
        word-wrap: break-word;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    
    [data-tooltip]:hover::before {
        content: '';
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%) translateY(100%);
        border: 5px solid transparent;
        border-top-color: rgba(0, 0, 0, 0.9);
        z-index: 1001;
    }
    
    /* Disable default CSS tooltip â€“ JS-powered tooltip handles display */
    [data-tooltip]:hover::after,
    [data-tooltip]:hover::before {
        display: none !important;
        content: none !important;
    }
    
    /* JavaScript tooltip styles */
    .tooltip {
        position: fixed;
        background: rgba(0, 0, 0, 0.9);
        color: white;
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 0.85rem;
        max-width: 300px;
        width: max-content;
        z-index: 10000;
        line-height: 1.4;
        word-wrap: break-word;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        pointer-events: none;
        opacity: 0;
        transform: translateY(5px);
        transition: opacity 0.2s ease, transform 0.2s ease;
    }
    
    .tooltip.show {
        opacity: 1;
        transform: translateY(0);
    }
    
    .tooltip.bottom {
        /* Additional styles for bottom-positioned tooltips if needed */
    }
    
    /* Mobile Performance Timeline Layout - Professional Accordion Design */
    @media (max-width: 992px) {
        /* Hide the traditional table and its wrapper on mobile */
        .table-wrapper {
            display: none !important;
        }
        
        /* Show timeline layout instead */
        .mobile-performance-timeline {
            display: block !important;
            margin: 0;
            padding: 0;
        }
        
        /* Show mobile hint */
        .mobile-hint {
            display: block !important;
        }
        
        .task-table-container {
            width: 100% !important;
            margin: 0 !important;
            padding: 0 10px;
        }
        
        /* Hide click hint on mobile */
        .click-hint-container {
            display: none;
        }
        
        /* Mobile sorting controls improvements */
        .sorting-controls {
            margin-bottom: 20px !important;
            padding: 15px !important;
            background: #f8f9fa !important;
            border-radius: 12px !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08) !important;
        }
        
        .sorting-controls label {
            font-size: 1.1rem !important;
            font-weight: 600 !important;
            color: #333 !important;
            display: block !important;
            text-align: center !important;
            margin-bottom: 12px !important;
        }
        
        .sort-buttons-container {
            display: flex !important;
            gap: 10px !important;
            flex-wrap: wrap !important;
            justify-content: center !important;
        }
        
        .sort-btn {
            padding: 12px 18px !important;
            font-size: 0.9rem !important;
            font-weight: 500 !important;
            border: 2px solid #e0e0e0 !important;
            background: white !important;
            border-radius: 25px !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            min-height: 44px !important;
            flex: 1 !important;
            min-width: 120px !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
        }
        
        .sort-btn.active {
            background: #2196F3 !important;
            color: white !important;
            border-color: #2196F3 !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 12px rgba(33,150,243,0.3) !important;
        }
        
        .sort-btn:hover:not(.active) {
            background: #f5f5f5 !important;
            border-color: #ccc !important;
            transform: translateY(-1px) !important;
        }
        /* NEW: First sort button full width on mobile */
        .sort-buttons-container .sort-btn:first-child {
            flex: 0 0 100% !important;
            max-width: 100% !important;
        }
        
        /* Performance Timeline Styles */
        .timeline-item {
            background: white;
            border-radius: 12px;
            margin-bottom: 12px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.08);
            border: 1px solid #e8e8e8;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .timeline-item:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.12);
            border-color: #2196F3;
        }
        
        .timeline-header {
            display: flex;
            align-items: center;
            padding: 16px;
            cursor: pointer;
            background: #fafafa;
            border-bottom: 1px solid #f0f0f0;
            min-height: 64px;
            user-select: none;
            transition: background-color 0.2s ease;
        }
        
        .timeline-header:hover {
            background: #f5f5f5;
        }
        
        .timeline-header:active {
            background: #f0f0f0;
        }
        
        .timeline-marker {
            width: 12px;
            height: 12px;
            background: linear-gradient(135deg, #2196F3, #1976D2);
            border-radius: 50%;
            margin-right: 16px;
            flex-shrink: 0;
            box-shadow: 0 2px 4px rgba(33,150,243,0.3);
        }
        
        .timeline-title-section {
            flex: 1;
            min-width: 0;
        }
        
        .timeline-task-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
            line-height: 1.3;
        }
        
        .timeline-summary {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .timeline-toggle {
            margin-left: 12px;
            flex-shrink: 0;
        }
        
        .timeline-arrow {
            font-size: 1.2rem;
            color: #666;
            transition: transform 0.3s ease;
            display: inline-block;
        }
        
        .timeline-item.expanded .timeline-arrow {
            transform: rotate(180deg);
        }
        
        .timeline-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out, padding 0.3s ease;
            background: white;
        }
        
        .timeline-item.expanded .timeline-content {
            max-height: none;
            padding: 16px;
        }
        
        /* Performance Strips */
        .performance-strips-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .performance-strip {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e9ecef;
            transition: all 0.2s ease;
        }
        
        .performance-strip:hover {
            background: #e3f2fd;
            border-color: #2196F3;
            transform: translateX(4px);
        }
        
        .performance-rank {
            font-size: 1.5rem;
            margin-right: 16px;
            flex-shrink: 0;
        }
        
        .performance-info {
            flex: 1;
            min-width: 0;
        }
        
        .performance-link {
            text-decoration: none;
            display: block;
        }
        
        .performance-badge {
            padding: 10px 16px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            transition: transform 0.2s ease;
        }
        
        .performance-link:hover .performance-badge {
            transform: scale(1.02);
        }
        
        /* Mobile interaction hint */
        .mobile-hint {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            color: #1976d2;
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 0.85rem;
            text-align: center;
            margin-bottom: 16px;
            border: 1px solid #bbdefb;
            font-weight: 500;
            box-shadow: 0 2px 6px rgba(0,0,0,0.06);
        }
        
        .mobile-hint::before {
            content: "ðŸ“± ";
            font-size: 1rem;
        }
    }
    
    /* Extra mobile optimizations for smaller screens */
    @media (max-width: 480px) {
        .task-table-container {
            padding: 0 5px !important;
        }
        
        .timeline-item {
            margin-bottom: 10px !important;
            border-radius: 10px !important;
        }
        
        .timeline-header {
            padding: 12px !important;
            min-height: 56px !important;
        }
        
        .timeline-marker {
            width: 10px !important;
            height: 10px !important;
            margin-right: 12px !important;
        }
        
        .timeline-task-name {
            font-size: 1rem !important;
            line-height: 1.2 !important;
        }
        
        .timeline-summary {
            font-size: 0.8rem !important;
        }
        
        .timeline-item.expanded .timeline-content {
            padding: 12px !important;
        }
        
        .performance-strips-container {
            gap: 8px !important;
        }
        
        .performance-strip {
            padding: 10px 12px !important;
            border-radius: 8px !important;
        }
        
        .performance-rank {
            font-size: 1.3rem !important;
            margin-right: 12px !important;
        }
        
        .performance-badge {
            padding: 8px 12px !important;
            font-size: 0.8rem !important;
        }
        
        /* Compact sorting controls for very small screens */
        .sorting-controls {
            padding: 12px !important;
            margin-bottom: 16px !important;
        }
        
        .sorting-controls label {
            font-size: 1rem !important;
            margin-bottom: 10px !important;
        }
        
        .sort-btn {
            font-size: 0.8rem !important;
            padding: 10px 14px !important;
            min-height: 40px !important;
            min-width: 100px !important;
        }
        
        .mobile-hint {
            font-size: 0.8rem !important;
            padding: 10px 12px !important;
            margin-bottom: 12px !important;
        }
    }
    
    /* Tablet-specific optimizations */
    @media (min-width: 769px) and (max-width: 1024px) {
        .task-table-container {
            width: 95% !important;
        }
        
        #task-summary-table {
            font-size: 0.95rem;
        }
        
        .score-badge {
            font-size: 0.85rem !important;
            padding: 5px 8px !important;
        }
    }
    </style>
    
    <script>
    function sortTable(sortType) {
        // Save sort state to localStorage
        localStorage.setItem('taskTableSortType', sortType);
        
        // Remove active class from all buttons
        document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
        
        // Add active class to clicked button
        document.getElementById('sort-' + sortType).classList.add('active');
        
        // Sort desktop table
        const tableBody = document.getElementById('task-table-body');
        if (tableBody) {
            const rows = Array.from(tableBody.getElementsByTagName('tr'));
            
            rows.sort((a, b) => {
                if (sortType === 'alphabetical') {
                    const nameA = a.dataset.taskName.toLowerCase();
                    const nameB = b.dataset.taskName.toLowerCase();
                    return nameA.localeCompare(nameB);
                } else if (sortType === 'speedup-desc') {
                    const speedupA = parseFloat(a.dataset.topSpeedup) || 0;
                    const speedupB = parseFloat(b.dataset.topSpeedup) || 0;
                    return speedupB - speedupA;
                } else if (sortType === 'speedup-asc') {
                    const speedupA = parseFloat(a.dataset.topSpeedup) || 0;
                    const speedupB = parseFloat(b.dataset.topSpeedup) || 0;
                    return speedupA - speedupB;
                }
            });
            
            rows.forEach(row => tableBody.appendChild(row));
        }
        
        // Sort mobile timeline items
        const mobileTimeline = document.querySelector('.mobile-performance-timeline');
        if (mobileTimeline) {
            const timelineItems = Array.from(mobileTimeline.getElementsByClassName('timeline-item'));
            
            timelineItems.sort((a, b) => {
                if (sortType === 'alphabetical') {
                    const nameA = a.dataset.taskName.toLowerCase();
                    const nameB = b.dataset.taskName.toLowerCase();
                    return nameA.localeCompare(nameB);
                } else if (sortType === 'speedup-desc') {
                    const speedupA = parseFloat(a.dataset.topSpeedup) || 0;
                    const speedupB = parseFloat(b.dataset.topSpeedup) || 0;
                    return speedupB - speedupA;
                } else if (sortType === 'speedup-asc') {
                    const speedupA = parseFloat(a.dataset.topSpeedup) || 0;
                    const speedupB = parseFloat(b.dataset.topSpeedup) || 0;
                    return speedupA - speedupB;
                }
            });
            
            timelineItems.forEach(item => mobileTimeline.appendChild(item));
        }
    }
    
    // Restore sort state on page load
    function restoreSortState() {
        const savedSortType = localStorage.getItem('taskTableSortType');
        if (savedSortType && ['alphabetical', 'speedup-desc', 'speedup-asc'].includes(savedSortType)) {
            sortTable(savedSortType);
        } else {
            // Default to alphabetical if no saved state
            sortTable('alphabetical');
        }
        
        // Restore scroll position
        const savedScrollPosition = localStorage.getItem('taskTableScrollPosition');
        if (savedScrollPosition) {
            // Use setTimeout to ensure DOM is ready and sorting is complete
            setTimeout(() => {
                window.scrollTo(0, parseInt(savedScrollPosition));
                // Clear the saved position after restoring
                localStorage.removeItem('taskTableScrollPosition');
            }, 100);
        }
    }
    
    // Save current sort state (called before navigation)
    function saveCurrentSortState() {
        const activeSortBtn = document.querySelector('.sort-btn.active');
        if (activeSortBtn) {
            const sortType = activeSortBtn.id.replace('sort-', '');
            localStorage.setItem('taskTableSortType', sortType);
        }
        // Save scroll position
        const speedupSection = document.getElementById('speedup-section');
        if (speedupSection) {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            localStorage.setItem('taskTableScrollPosition', scrollTop);
        }
    }
    
    // Performance Timeline Accordion functionality
    function toggleTimelineItem(headerElement) {
        const timelineItem = headerElement.closest('.timeline-item');
        const isExpanded = timelineItem.classList.contains('expanded');
        
        if (isExpanded) {
            timelineItem.classList.remove('expanded');
        } else {
            timelineItem.classList.add('expanded');
        }
    }
    
    // Smart tooltip functionality
    let currentTooltip = null;
    let tooltipTimeout = null;
    let currentCell = null;
    
    function createTooltip(element, text) {
        // Clear any pending removal
        if (tooltipTimeout) {
            clearTimeout(tooltipTimeout);
            tooltipTimeout = null;
        }
        
        // If tooltip already exists for the same element, don't recreate
        if (currentTooltip && currentCell === element) {
            return;
        }
        
        // Remove any existing tooltip
        if (currentTooltip) {
            currentTooltip.remove();
            currentTooltip = null;
        }
        
        currentCell = element;
        
        // Truncate text to 500 characters and add ellipsis if needed
        let displayText = text;
        if (text.length > 500) {
            displayText = text.substring(0, 500) + '...';
        }
        
        const tooltip = document.createElement('div');
        tooltip.className = 'tooltip';
        tooltip.textContent = displayText;
        document.body.appendChild(tooltip);
        
        // Position tooltip
        const rect = element.getBoundingClientRect();
        const tooltipRect = tooltip.getBoundingClientRect();
        
        // Calculate preferred position (above the element)
        let left = rect.left + (rect.width / 2) - (tooltipRect.width / 2);
        let top = rect.top - tooltipRect.height - 10;
        
        // Check if tooltip goes outside viewport and adjust
        const viewportWidth = window.innerWidth;
        const viewportHeight = window.innerHeight;
        
        // Adjust horizontal position if needed
        if (left < 10) {
            left = 10;
        } else if (left + tooltipRect.width > viewportWidth - 10) {
            left = viewportWidth - tooltipRect.width - 10;
        }
        
        // If tooltip would go above viewport, show it below instead
        if (top < 10) {
            top = rect.bottom + 10;
            tooltip.classList.add('bottom');
        }
        
        // Ensure tooltip doesn't go below viewport
        if (top + tooltipRect.height > viewportHeight - 10) {
            top = viewportHeight - tooltipRect.height - 10;
        }
        
        tooltip.style.left = left + 'px';
        tooltip.style.top = top + 'px';
        
        // Show tooltip with animation
        setTimeout(() => tooltip.classList.add('show'), 10);
        
        currentTooltip = tooltip;
    }
    
    function removeTooltip(immediate = false) {
        if (tooltipTimeout) {
            clearTimeout(tooltipTimeout);
            tooltipTimeout = null;
        }
        
        if (immediate) {
            if (currentTooltip) {
                currentTooltip.classList.remove('show');
                setTimeout(() => {
                    if (currentTooltip) {
                        currentTooltip.remove();
                        currentTooltip = null;
                        currentCell = null;
                    }
                }, 200);
            }
        } else {
            // Add a small delay to prevent flickering when moving within the cell
            tooltipTimeout = setTimeout(() => {
                if (currentTooltip) {
                    currentTooltip.classList.remove('show');
                    setTimeout(() => {
                        if (currentTooltip) {
                            currentTooltip.remove();
                            currentTooltip = null;
                            currentCell = null;
                        }
                    }, 200);
                }
                tooltipTimeout = null;
            }, 100);
        }
    }
    
    function isMouseOverCell(cell, event) {
        const rect = cell.getBoundingClientRect();
        return event.clientX >= rect.left && 
               event.clientX <= rect.right && 
               event.clientY >= rect.top && 
               event.clientY <= rect.bottom;
    }
    
    // Detect touch device
    function isTouchDevice() {
        return 'ontouchstart' in window || navigator.maxTouchPoints > 0;
    }
    
    // Add event listeners to task name cells  
    document.addEventListener('DOMContentLoaded', function() {
        // Restore table sort state
        restoreSortState();
        
        // Save sort state before navigating to any trajectory page
        document.addEventListener('click', function(e) {
            const link = e.target.closest('a[href$=".html"]');
            if (link && link.href.includes('.html') && !link.href.includes('index.html')) {
                saveCurrentSortState();
            }
        });
        const taskCells = document.querySelectorAll('.task-name-cell[data-tooltip]');
        const isTouch = isTouchDevice();
        
        taskCells.forEach(cell => {
            if (isTouch) {
                // Touch device handling
                let touchStartTime = 0;
                let isLongPress = false;
                let touchTimer = null;
                
                cell.addEventListener('touchstart', function(e) {
                    touchStartTime = Date.now();
                    isLongPress = false;
                    
                    // Set up long press detection
                    touchTimer = setTimeout(() => {
                        isLongPress = true;
                        const tooltipText = this.getAttribute('data-tooltip');
                        if (tooltipText) {
                            // Prevent default to avoid triggering click
                            e.preventDefault();
                            createTooltip(this, tooltipText);
                            
                            // Provide haptic feedback if available
                            if (navigator.vibrate) {
                                navigator.vibrate(50);
                            }
                        }
                    }, 600); // 600ms long press
                });
                
                cell.addEventListener('touchend', function(e) {
                    if (touchTimer) {
                        clearTimeout(touchTimer);
                        touchTimer = null;
                    }
                    
                    const touchDuration = Date.now() - touchStartTime;
                    
                    if (isLongPress) {
                        // If it was a long press, don't trigger click
                        e.preventDefault();
                        e.stopPropagation();
                        
                        // Auto-hide tooltip after 5 seconds on touch devices
                        setTimeout(() => {
                            removeTooltip(true);
                        }, 5000);
                    }
                });
                
                cell.addEventListener('touchcancel', function(e) {
                    if (touchTimer) {
                        clearTimeout(touchTimer);
                        touchTimer = null;
                    }
                    isLongPress = false;
                });
                
                // Double tap to navigate, single tap to show tooltip
                let lastTap = 0;
                cell.addEventListener('click', function(e) {
                    if (!isLongPress) {
                        const currentTime = new Date().getTime();
                        const tapLength = currentTime - lastTap;
                        
                        if (tapLength < 500 && tapLength > 0) {
                            // Double tap - allow navigation
                            lastTap = 0;
                            removeTooltip(true);
                            return true; // Allow default click behavior
                        } else {
                            // Single tap - show tooltip
                            lastTap = currentTime;
                            
                            const tooltipText = this.getAttribute('data-tooltip');
                            if (tooltipText) {
                                if (currentTooltip && currentCell === this) {
                                    // Hide existing tooltip
                                    removeTooltip(true);
                                } else {
                                    // Show new tooltip
                                    createTooltip(this, tooltipText);
                                    
                                    // Auto-hide after 4 seconds on mobile
                                    setTimeout(() => {
                                        removeTooltip(true);
                                    }, 4000);
                                }
                            }
                            
                            // Prevent navigation on single tap
                            e.preventDefault();
                            e.stopPropagation();
                            return false;
                        }
                    }
                });
                
            } else {
                // Desktop mouse handling
                cell.addEventListener('mouseenter', function(e) {
                    const tooltipText = this.getAttribute('data-tooltip');
                    if (tooltipText) {
                        createTooltip(this, tooltipText);
                    }
                });
                
                cell.addEventListener('mouseleave', function(e) {
                    // Check if mouse is actually leaving the cell area
                    if (!isMouseOverCell(this, e)) {
                        removeTooltip();
                    }
                });
                
                // Handle mouse movement within the cell
                cell.addEventListener('mousemove', function(e) {
                    // If we have a pending removal and mouse is still in cell, cancel it
                    if (tooltipTimeout && isMouseOverCell(this, e)) {
                        clearTimeout(tooltipTimeout);
                        tooltipTimeout = null;
                    }
                    
                    // Ensure tooltip is shown if we're in the cell
                    const tooltipText = this.getAttribute('data-tooltip');
                    if (tooltipText && (!currentTooltip || currentCell !== this)) {
                        createTooltip(this, tooltipText);
                    }
                });
            }
        });
        
        if (!isTouch) {
            // Global mouse move handler to clean up tooltips when mouse leaves the table area (desktop only)
            document.addEventListener('mousemove', function(e) {
                if (currentTooltip && currentCell) {
                    if (!isMouseOverCell(currentCell, e)) {
                        // Check if mouse is over the tooltip itself
                        const tooltipRect = currentTooltip.getBoundingClientRect();
                        const overTooltip = e.clientX >= tooltipRect.left && 
                                          e.clientX <= tooltipRect.right && 
                                          e.clientY >= tooltipRect.top && 
                                          e.clientY <= tooltipRect.bottom;
                        
                        if (!overTooltip) {
                            removeTooltip(true);
                        }
                    }
                }
            });
        } else {
            // Touch-specific: tap outside to hide tooltip
            document.addEventListener('touchstart', function(e) {
                if (currentTooltip && currentCell) {
                    const rect = currentCell.getBoundingClientRect();
                    const touch = e.touches[0];
                    const isOutside = touch.clientX < rect.left || 
                                    touch.clientX > rect.right || 
                                    touch.clientY < rect.top || 
                                    touch.clientY > rect.bottom;
                    
                    if (isOutside) {
                        removeTooltip(true);
                    }
                }
            });
        }
    });
    
    // Timeline task name tooltip functionality for mobile
    document.addEventListener('DOMContentLoaded', function() {
        const timelineTaskNames = document.querySelectorAll('.timeline-task-name[data-tooltip]');
        const isTouch = isTouchDevice();
        
        timelineTaskNames.forEach(taskName => {
            if (isTouch) {
                // Touch device handling for timeline task names
                let touchStartTime = 0;
                let isLongPress = false;
                let touchTimer = null;
                
                taskName.addEventListener('touchstart', function(e) {
                    touchStartTime = Date.now();
                    isLongPress = false;
                    
                    touchTimer = setTimeout(() => {
                        isLongPress = true;
                        const tooltipText = this.getAttribute('data-tooltip');
                        if (tooltipText) {
                            e.preventDefault();
                            createTooltip(this, tooltipText);
                            
                            if (navigator.vibrate) {
                                navigator.vibrate(50);
                            }
                        }
                    }, 600);
                });
                
                taskName.addEventListener('touchend', function(e) {
                    if (touchTimer) {
                        clearTimeout(touchTimer);
                        touchTimer = null;
                    }
                    
                    if (isLongPress) {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        setTimeout(() => {
                            removeTooltip(true);
                        }, 5000);
                    }
                });
                
                taskName.addEventListener('touchcancel', function(e) {
                    if (touchTimer) {
                        clearTimeout(touchTimer);
                        touchTimer = null;
                    }
                    isLongPress = false;
                });
            } else {
                // Desktop mouse handling for timeline task names
                taskName.addEventListener('mouseenter', function(e) {
                    const tooltipText = this.getAttribute('data-tooltip');
                    if (tooltipText) {
                        createTooltip(this, tooltipText);
                    }
                });
                
                taskName.addEventListener('mouseleave', function(e) {
                    if (!isMouseOverCell(this, e)) {
                        removeTooltip();
                    }
                });
                
                taskName.addEventListener('mousemove', function(e) {
                    if (tooltipTimeout && isMouseOverCell(this, e)) {
                        clearTimeout(tooltipTimeout);
                        tooltipTimeout = null;
                    }
                    
                    const tooltipText = this.getAttribute('data-tooltip');
                    if (tooltipText && (!currentTooltip || currentCell !== this)) {
                        createTooltip(this, tooltipText);
                    }
                });
            }
        });
    });
    </script>
        </div>
    </section>

</body>
</html>